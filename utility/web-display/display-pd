<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Molipe · 8× MIDI Controls (0–127)</title>
<style>
  :root { font-family: system-ui, sans-serif; background:#000; color:#eee; }

  .wrap {
    display:grid; gap:16px;
    grid-template-columns: repeat(4, minmax(120px, 1fr));
    padding:20px;
  }

  /* Card: Label oben, direkt darunter der Knob-Bereich ohne Abstand */
  .card {
    display: grid;
    grid-template-rows: auto 1fr; /* Label | SVG-Bereich */
    row-gap: 0;                   /* << 0 px Abstand */
    align-items: start;
    background:#000; border-radius:14px; padding:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.35);
    font-size: clamp(10px, 1.8vw, 26px);
  }

  .label {
    margin: 0 !important;         /* << kein Margin */
    opacity:.95; text-align:center;
    font-size: 1.6em; font-weight:700;
    letter-spacing:.04em; text-transform:uppercase;
    line-height:1.1;
  }

  /* Knob-Container: kein Padding oben (0 px zum Label), unten Platz für Zahl */
  .knob {
    position: relative;
    width: 100%;
    padding-top: 0 !important;    /* << 0 px Label→SVG */
    padding-bottom: 30px;          /* Platz für Zahl unten (überlappt nicht) */
  }

  .midi {
    --v:0; --t:0;
    aspect-ratio:1/1;
    width:100%;
    border-radius:12px;
    overflow:hidden;
    display:block;
  }

  /* Zahl unten (fixer Abstand, ohne Überlappung) */
  .value {
    position:absolute;
    left:0; right:0;
    bottom:10px;                   /* fixer Abstand unterhalb der SVG */
    text-align:center;
    font-size: 2em;
    line-height:1;
    color:#ddd;
    pointer-events:none;
  }

  /* Dotted-Ring (Startpunkt unten = +90°) */
  .ring .track {
    fill:none;
    stroke:#eeeeee;
    stroke-width:11;
    stroke-dasharray:0 1.3;
    pathLength:127;
  }
  .ring .arc {
    fill:none;
    stroke-width:11;
    stroke-linecap:round;
    stroke-dasharray: calc(var(--v)) 127;
    transform: rotate(90deg);
    transform-origin:50% 50%;
  }

  /* Farben */
  #ctrl1 .arc { stroke:#ff5555; }
  #ctrl2 .arc { stroke:#ffaa00; }
  #ctrl3 .arc { stroke:#ffee55; }
  #ctrl4 .arc { stroke:#55ff55; }
  #ctrl5 .arc { stroke:#55ffee; }
  #ctrl6 .arc { stroke:#5588ff; }
  #ctrl7 .arc { stroke:#aa55ff; }
  #ctrl8 .arc { stroke:#ff55aa; }

  /* Test-Slider */
  .ctrl {
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:10px;
    padding:0 20px 20px;
  }
  .ctrl .row { display:flex; gap:10px; align-items:center; }
  .ctrl label { opacity:.7; width:3em; }
  input[type="range"]{ width:100%; }
</style>
</head>
<body>

<div class="wrap">
  <!-- 8 Controls -->
  <div class="card">
    <div class="label">FREQ</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl1">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val1">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">DECAY</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl2">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val2">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">SWEEP</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl3">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val3">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">DIST</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl4">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val4">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">CTRL 5</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl5">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val5">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">CTRL 6</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl6">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val6">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">CTRL 7</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl7">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val7">0</div>
    </div>
  </div>

  <div class="card">
    <div class="label">CTRL 8</div>
    <div class="knob">
      <svg class="midi ring" viewBox="0 0 100 100" id="ctrl8">
        <circle class="track" cx="50" cy="50" r="44"/>
        <circle class="arc"   cx="50" cy="50" r="44" pathLength="127"/>
      </svg>
      <div class="value" id="val8">0</div>
    </div>
  </div>
</div>

<!-- Test-Slider -->
<div class="ctrl">
  <div class="row"><label>567</label><input type="range" min="0" max="127" value="0" data-idx="1"></div>
  <div class="row"><label>2</label><input type="range" min="0" max="127" value="0" data-idx="2"></div>
  <div class="row"><label>3</label><input type="range" min="0" max="127" value="0" data-idx="3"></div>
  <div class="row"><label>4</label><input type="range" min="0" max="127" value="0" data-idx="4"></div>
  <div class="row"><label>5</label><input type="range" min="0" max="127" value="0" data-idx="5"></div>
  <div class="row"><label>6</label><input type="range" min="0" max="127" value="0" data-idx="6"></div>
  <div class="row"><label>7</label><input type="range" min="0" max="127" value="0" data-idx="7"></div>
  <div class="row"><label>8</label><input type="range" min="0" max="127" value="0" data-idx="8"></div>
</div>

<script>
  // 0..127 → CSS-Variablen und Zahl
  function setMidi(el, value){
    const v = Math.max(0, Math.min(127, Math.round(value)));
    el.style.setProperty('--v', v);
    el.style.setProperty('--t', v/127);
    const id = el.id.replace('ctrl','val');
    const out = document.getElementById(id);
    if (out) out.textContent = v;
  }

  const controls = [
    'ctrl1','ctrl2','ctrl3','ctrl4',
    'ctrl5','ctrl6','ctrl7','ctrl8'
  ].map(id => document.getElementById(id));

  document.querySelectorAll('.ctrl input[type="range"]').forEach(sl => {
    sl.addEventListener('input', e => {
      const idx = Number(e.target.dataset.idx) - 1;
      setMidi(controls[idx], e.target.value);
    });
  });

  controls.forEach(el => setMidi(el, 0));
</script>
</body>
</html>
